<!doctype html>
<html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JSON / DOCX / CSV — AnyConvert</title>
<link rel="stylesheet" href="site.css">
</head><body>
<header>
  <div class="title"><div class="logo">⚡</div><h1>JSON / DOCX / CSV</h1></div>
  <nav class="tabs">
    <a class="tab" href="images.html">Images</a>
    <a class="tab" href="documents.html">Docs/PDF</a>
    <a class="tab active" href="json.html">JSON/Doc/CSV</a>
    <a class="tab" href="data.html">Data</a>
    <a class="tab" href="audio.html">Audio</a>
    <a class="tab" href="video.html">Video</a>
    <a class="tab" href="archive.html">Archive</a>
    <a class="tab" href="about.html">About</a>
  </nav>
</header>
<main>
<section id="tab-json" class="panel">
  <div class="grid">
    <div class="card">
      <span class="badge">UPGRADED</span>
      <h3>JSON ⇄ CSV (with preview)</h3>
      <div class="row"><textarea id="json-input" placeholder='[{"id":1,"user":{"name":"Alice","tags":["pro","beta"]}},{"id":2,"user":{"name":"Bob"}}]'></textarea></div>
      <div class="row">
        <input type="file" id="json-file" accept="application/json,.json" />
        <button id="json-preview">Preview</button>
        <button id="json-to-csv">Download CSV</button>
      </div>
      <div class="row">
        <label class="small"><input type="checkbox" id="json-explode-arr" /> Explode first array column</label>
        <label class="small"><input type="checkbox" id="json-stringify-nonprim" checked /> Stringify non-primitives</label>
      </div>
      <div id="json-preview-area" class="preview hidden"></div>
      <div class="log" id="json-log"></div>
      <hr style="border:none;border-top:1px solid #1f2433;margin:14px 0">
      <h4>CSV → JSON</h4>
      <div class="row">
        <input type="file" id="csv-file" accept="text/csv,.csv" />
        <button id="csv-preview">Preview</button>
        <button id="csv-to-json">Download JSON</button>
      </div>
      <div id="csv-preview-area" class="preview hidden"></div>
      <div class="log" id="csv-log"></div>
    </div>

    <div class="card">
      <span class="badge">NEW</span>
      <h3>JSON ⇄ DOCX (with preview)</h3>
      <h4>JSON → DOCX</h4>
      <div class="row"><textarea id="jsondoc-input" placeholder='[{"name":"Alice","email":"a@example.com"},{"name":"Bob","email":"b@example.com"}]'></textarea></div>
      <div class="row">
        <input type="file" id="jsondoc-file" accept="application/json,.json" />
        <select id="jsondoc-mode"><option value="table">Table</option><option value="blocks">Key/Value Blocks</option></select>
        <input type="text" id="jsondoc-title" placeholder="Optional title" />
      </div>
      <div class="row">
        <button id="jsondoc-preview">Preview</button>
        <button id="jsondoc-docx">Download DOCX</button>
      </div>
      <div id="jsondoc-preview-box" class="preview hidden"></div>
      <div class="log" id="jsondoc-log"></div>

      <hr style="border:none;border-top:1px solid #1f2433;margin:14px 0">
      <h4>DOCX → HTML/TXT/JSON</h4>
      <div class="row">
        <input type="file" id="docx-in" accept=".docx,application/vnd.openxmlformats-officedocument.wordprocessingml.document" />
        <button id="docx-to-html">Convert & Preview</button>
        <button id="docx-dl-html" class="secondary" disabled>Download HTML</button>
        <button id="docx-dl-txt" class="secondary" disabled>Download TXT</button>
        <button id="docx-extract-json" class="secondary" disabled>Extract → JSON</button>
      </div>
      <div id="docx-html-preview" class="preview hidden"></div>
      <div class="log" id="docx-log"></div>
    </div>
  </div>
</section>
</main>
<footer><p>© <span id="year"></span> File Converter — Cyber Edition</p></footer>
<script src="js/utils.js"></script>
<script>
  window.ensureMammoth = () => new Promise(res=>{
    if (window.mammoth) return res();
    const s=document.createElement('script'); s.src='https://unpkg.com/mammoth@1.6.0/mammoth.browser.min.js'; s.onload=res; document.body.appendChild(s);
  });
</script>
<script src="js/utils.js"></script>
<script src="js/boot.js"></script>
<script src="js/boot-json.js"></script>
<script src="js/json.js"></script></body></html>